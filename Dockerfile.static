ARG FRONTEND_IMAGE
ARG PUBLIC_URL
ARG REACT_APP_KOMPASSI_BASE_URL
ARG REACT_APP_CLIENT_ID

FROM $FRONTEND_IMAGE
USER root

ENV NODE_ENV=production
ENV PUBLIC_URL=$PUBLIC_URL
ENV REACT_APP_CLIENT_ID=$REACT_APP_CLIENT_ID
ENV REACT_APP_KOMPASSI_BASE_URL=$REACT_APP_KOMPASSI_BASE_URL

RUN npm run build

FROM nginx:1-alpine
COPY --from=0 /usr/src/app/build/ /usr/share/nginx/html/
